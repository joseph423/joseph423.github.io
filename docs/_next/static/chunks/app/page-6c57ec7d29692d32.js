(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{565:function(e,t,n){Promise.resolve().then(n.bind(n,2054))},7233:function(e,t,n){"use strict";n.d(t,{I:function(){return o},X:function(){return i}});var r=n(4762),a=n(6792),s=n(9826);let i=async()=>{let e=await s.u.get({key:a.I.SAVED_TAPS});return"string"==typeof(null==e?void 0:e.value)?(0,r.X)(e.value):new Map},o=async()=>{let e=await s.u.get({key:a.I.TAP_CHANGE_HISTORIES});return"string"==typeof(null==e?void 0:e.value)?(0,r.X)(e.value):new Map}},2054:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var r=n(7437),a=n(2265),s=n(3423),i=n(9950),o=n(9666),l=n(6548),c=n(9826);function u(e){let{children:t,extraClassName:n="",onClick:a}=e;return(0,r.jsx)(l.Z,{variant:"contained",className:"relative rounded-full p-0 before:float-left before:pb-[100%] before:content-[''] ".concat(n),onClick:a,children:t})}var d=n(3287),f=n(354),v=n(8067),h=n(8361),x=n(6140),m=n(7561);function g(e){return(0,r.jsx)(m.Z,{InputLabelProps:{shrink:!0},...e})}var p=n(1068),j=n(4820);function S(e){let{isOpened:t,handleClickReset:n,handleClickCancel:s}=e,[i,o]=(0,a.useState)(""),[c,u]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{!0===t&&o("")},[t]),(0,r.jsxs)(d.Z,{open:t,onClose:s,children:[(0,r.jsx)(x.Z,{children:"Reset Counter"}),(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(h.Z,{children:"You may specify a number, or leave it empty which by default will reset to zero."}),(0,r.jsx)(g,{type:"number",label:"Reset To",placeholder:"0",fullWidth:!0,value:i,onChange:e=>{o(t=>{if(e.target.value.length>10)return t;let n=Number(e.target.value);return""===e.target.value?e.target.value:n})},className:"mt-4"}),(0,r.jsx)(p.Z,{control:(0,r.jsx)(j.Z,{onChange:e=>{u(e.target.checked)},checked:c}),label:"Reset as an unsaved counter"})]}),(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(l.Z,{onClick:s,children:"Cancel"}),(0,r.jsx)(l.Z,{onClick:()=>n(Number(i),c),children:"Reset"})]})]})}var C=n(2326),b=n(437);function y(e){let{isOpened:t,handleClickSave:n,handleClickCancel:s,loadedSave:i}=e,[o,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{!0===t&&c(void 0!==i?i.name:"")},[t,i]),(0,r.jsxs)(d.Z,{open:t,onClose:s,children:[(0,r.jsx)(x.Z,{children:"Save Counter"}),(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(h.Z,{children:"To avoid confusion with other saves, an unique name is recommended."}),(0,r.jsx)(g,{label:"Save Name",placeholder:"(Unnamed)",fullWidth:!0,InputProps:{endAdornment:(0,r.jsxs)(C.Z,{position:"end",children:[o.length,"/",50]})},value:o,onChange:e=>{c(t=>e.target.value.length>50?t:e.target.value)},className:"mt-4"}),""!==o&&void 0!==i&&o!==i.name&&!1===u&&(0,r.jsxs)(b.Z,{className:"truncate",children:["Rename as ",(0,r.jsx)("b",{children:o})]}),void 0!==i&&(0,r.jsx)(p.Z,{control:(0,r.jsx)(j.Z,{onChange:e=>{m(e.target.checked)},checked:u}),label:"Save as a new copy"})]}),(0,r.jsxs)(f.Z,{children:[(0,r.jsx)(l.Z,{onClick:s,children:"Cancel"}),(0,r.jsx)(l.Z,{onClick:()=>n(o,u),children:"Save"})]})]})}var N=n(6792),Z=n(6461),k=n(4762),w=n(7233),E=n(9936),A=n(6762),T=n(9570),I=n(8472);let _=e=>{let{tapCount:t}=e;return 0===t?"Tap to Count":1===t?"".concat(t," Tap"):t>1?"".concat(t," Taps"):void 0};function P(){let e=(0,Z.t8)(),[t,n]=(0,a.useState)(void 0),[d,f]=(0,a.useState)(0),[v,h]=(0,a.useState)(!1),[x,m]=(0,a.useState)(!1);(0,T.D)({mutationFn:e=>(console.log("mutationFn()",e),I.Z.post("/api/ping",e)),onSuccess:()=>{},onError:()=>{}});let g=async e=>{let t=await (0,w.I)();t.set(e.id,e),t.size>N.QK&&t.delete(Array.from(t.keys())[0]),await c.u.set({key:N.I.TAP_CHANGE_HISTORIES,value:(0,k.w)(t)})},p=async()=>{if(console.log("handleClickOpenSaveDialog()"),(await (0,w.X)()).size>N.G_){e("You have reached the max tap save count. Please remove some of your saves to continue.");return}h(!0)},j=async(r,a)=>{let s;let i=new Date,o=await (0,w.X)(),l=!1;a||void 0===t||void 0===o.get(t.id)?(s={id:i.getTime().toString(),name:r,tapCount:d,createdAt:i.toISOString()},o.delete(s.id),l=!0):s={...t,name:r,tapCount:d,updatedAt:i.toISOString()},o=new Map([...Array.from(o.entries()),[s.id,s]]),l&&o.size>N.G_&&e("You have reached the max tap save count. Please remove some of your saves to continue.");let u=[c.u.set({key:N.I.SAVED_TAPS,value:(0,k.w)(o)})];l&&u.push(c.u.set({key:N.I.LOADED_SAVE_ID,value:s.id})),g({id:i.getTime().toString(),tap:s,action:"SAVE",createdAt:i.toISOString()}),Promise.allSettled(u),n(s),h(!1),e("The tap is saved.")};return(0,a.useEffect)(()=>{Promise.allSettled([new Promise(async e=>{let t=await c.u.get({key:N.I.LOADED_SAVE_ID});if("string"==typeof(null==t?void 0:t.value)){let e;let r=await c.u.get({key:N.I.SAVED_TAPS});if("string"==typeof r.value&&(e=(0,k.X)(r.value)),void 0!==e){let r=e.get(t.value);void 0!==r&&n(r)}}e(!0)}),new Promise(async e=>{let t=await c.u.get({key:N.I.TAP_COUNT});console.log("tap count res",t),"string"==typeof(null==t?void 0:t.value)&&f(Number.parseInt(t.value)),e(!0)})])},[]),(0,r.jsx)(A.Z,{children:(0,r.jsxs)("div",{className:"m-auto flex h-full max-w-2xl flex-col justify-center p-4",children:[(0,r.jsxs)("div",{className:"flex w-full justify-between gap-3",children:[(0,r.jsx)(l.Z,{variant:"contained",className:"flex h-fit flex-col justify-start overflow-hidden bg-transparent p-0 text-theme-txt shadow-none hover:bg-transparent hover:shadow-none",onClick:p,children:(0,r.jsxs)("div",{className:"relative rounded-md py-2 pl-3 pr-2 before:absolute before:left-0 before:top-0 before:h-full before:w-1 before:bg-theme-sec before:content-['']",children:[void 0!==t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.J,{extraClassName:"mx-2 max-w-[150px] truncate px-1 text-xs font-medium normal-case",name:t.name}),(0,r.jsx)("div",{className:"my-1 w-full border-b border-solid border-theme-txt/25"})]}),(0,r.jsxs)("div",{className:"mx-2 flex items-center",children:[(0,r.jsx)(s.Z,{className:"text-xl"}),(0,r.jsx)("span",{className:"ml-1 text-sm normal-case leading-[normal]",children:"Click to Save"})]})]})}),(0,r.jsx)(y,{isOpened:v,handleClickSave:j,handleClickCancel:()=>h(!1),loadedSave:t}),(0,r.jsx)(u,{extraClassName:"w-28 bg-theme-acc text-theme-bg hover:bg-theme-acc-hover",onClick:()=>m(!0),children:(0,r.jsxs)("div",{children:[(0,r.jsx)(i.Z,{className:"text-2xl"}),(0,r.jsx)("div",{className:"text-base",children:"Reset"})]})}),(0,r.jsx)(S,{isOpened:x,handleClickReset:(r,a)=>{console.log("resetDialogHandleClickReset()",{resetCount:r,shouldResetAsUnsaved:a});let s=new Date,i=void 0===r||isNaN(r)?0:r;c.u.set({key:N.I.TAP_COUNT,value:i.toString()}),g({id:s.getTime().toString(),tap:void 0!==t?t:{tapCount:d},action:"RESET",createdAt:s.toISOString()}),a&&(c.u.remove({key:N.I.LOADED_SAVE_ID}),n(void 0)),f(i),m(!1),e("The tap is reset.")},handleClickCancel:()=>m(!1)})]}),(0,r.jsx)(u,{extraClassName:"hover:bg-theme-pri-txt -mt-3 w-full bg-theme-pri text-theme-bg-950 hover:bg-theme-pri-hover focus:bg-theme-pri-hover",onClick:()=>{console.log("handleClickTap()"),f(e=>{let t=(e+1).toString().length<=10?e+1:e;return c.u.set({key:N.I.TAP_COUNT,value:t.toString()}),t})},children:(0,r.jsxs)("div",{className:"pt-4",children:[(0,r.jsx)("div",{className:"pb-3 text-4xl",children:(0,r.jsx)(_,{tapCount:d})}),(0,r.jsx)(o.Z,{className:"text-9xl"})]})})]})})}},354:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(7437),a=n(8784);function s(e){return(0,r.jsx)(a.Z,{...e})}},8361:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(7437),a=n(3269);function s(e){return(0,r.jsx)(a.Z,{...e})}},8067:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(7437),a=n(385);function s(e){return(0,r.jsx)(a.Z,{...e})}},6140:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(7437),a=n(824);function s(e){return(0,r.jsx)(a.Z,{...e})}},3287:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(7437),a=n(1096);function s(e){return(0,r.jsx)(a.Z,{...e})}},6762:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437),a=n(4426),s=n(4987);function i(e){let{children:t}=e,n=(0,s.$o)(),i=(0,a.hB)();return(0,r.jsx)("div",{className:"h-full w-full",style:{paddingTop:null==n?void 0:n.offsetHeight,paddingBottom:null==i?void 0:i.offsetHeight},children:t})}},9936:function(e,t,n){"use strict";n.d(t,{J:function(){return s}});var r=n(7437),a=n(511);let s=e=>{let{extraClassName:t,component:n="div",name:s}=e,i=void 0!==s&&""!==s;return(0,r.jsx)(a.Z,{component:n,variant:"body1",className:"".concat(i?"text-theme-txt":"text-theme-txt/50"," ").concat(t),children:i?s:"(Unnamed)"})}},4426:function(e,t,n){"use strict";n.d(t,{hB:function(){return l},t9:function(){return o}});var r=n(7437),a=n(9412),s=n(2265);let i=(0,s.createContext)(void 0),o=e=>{let{navBarRef:t,children:n}=e,[o]=(0,a.h)(t);return(0,s.useEffect)(()=>{console.log({navBarSize:o})},[o]),(0,r.jsx)(i.Provider,{value:o,children:n})},l=()=>(0,s.useContext)(i)},6461:function(e,t,n){"use strict";n.d(t,{T1:function(){return o},t8:function(){return l}});var r=n(7437),a=n(2265);let s=(0,a.createContext)(null),i=(0,a.createContext)(null),o=e=>{let{children:t,isOpened:n,showNotificationMessage:a}=e;return(0,r.jsx)(s.Provider,{value:n,children:(0,r.jsx)(i.Provider,{value:a,children:t})})},l=()=>(0,a.useContext)(i)},4987:function(e,t,n){"use strict";n.d(t,{$o:function(){return l},gP:function(){return o}});var r=n(7437),a=n(9412),s=n(2265);let i=(0,s.createContext)(void 0),o=e=>{let{topBarRef:t,children:n}=e,[o]=(0,a.h)(t);return(0,s.useEffect)(()=>{console.log({topBarSize:o})},[o]),(0,r.jsx)(i.Provider,{value:o,children:n})},l=()=>(0,s.useContext)(i)},9412:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(2265);let a=e=>{let[t,n]=(0,r.useState)({clientWidth:void 0,clientHeight:void 0,offsetWidth:void 0,offsetHeight:void 0});return(0,r.useEffect)(()=>{let t;console.log("useElementSize.useEffect",{targetElRef:e});let r=null==e?void 0:e.current;return void 0!==r&&((t=()=>{console.log("useElementSize.useEffect.handleResize()"),n({clientWidth:r.clientWidth,clientHeight:r.clientHeight,offsetWidth:r.offsetWidth,offsetHeight:r.offsetHeight})})(),r.addEventListener("resize",t)),()=>{void 0!==t&&void 0!==r&&r.removeEventListener("resize",t)}},[e]),[t]}},4762:function(e,t,n){"use strict";n.d(t,{X:function(){return a},w:function(){return r}});let r=e=>JSON.stringify(Array.from(e)),a=e=>(console.log("jsonToMap()",{json:e}),new Map(JSON.parse(e)))},6792:function(e,t,n){"use strict";n.d(t,{EN:function(){return r},G_:function(){return i},I:function(){return a},QK:function(){return o},pz:function(){return s}});let r={text:"#1e1e24",background:"#fff8f0",primary:"#c23d0c"},a={TAP_COUNT:"tap-count",LOADED_SAVE_ID:"loaded-save-id",SAVED_TAPS:"saved-taps",TAP_CHANGE_HISTORIES:"tap-change-histories"},s=10,i=200,o=1e3}},function(e){e.O(0,[944,124,67,810,596,971,23,744],function(){return e(e.s=565)}),_N_E=e.O()}]);