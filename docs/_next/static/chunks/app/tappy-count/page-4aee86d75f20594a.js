(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1213],{62802:function(e,t,n){Promise.resolve().then(n.bind(n,33510))},57233:function(e,t,n){"use strict";n.d(t,{I:function(){return o},X:function(){return l}});var a=n(34762),r=n(26792),s=n(9826);let l=async()=>{let e=await s.u.get({key:r.I.SAVED_TAPS});return"string"==typeof(null==e?void 0:e.value)?(0,a.Xe)(e.value):new Map},o=async()=>{let e=await s.u.get({key:r.I.TAP_CHANGE_HISTORIES});return"string"==typeof(null==e?void 0:e.value)?(0,a.Xe)(e.value):new Map}},33510:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var a=n(57437),r=n(2265),s=n(73423),l=n(69950),o=n(9666),i=n(60091),u=n(9826);function c(e){let{children:t,extraClassName:n="",onClick:r}=e;return(0,a.jsx)(i.Z,{variant:"contained",className:"relative rounded-full p-0 before:float-left before:pb-[100%] before:content-[''] ".concat(n),onClick:r,children:t})}var d=n(13287),f=n(90354),v=n(98067),x=n(58361),h=n(76140),m=n(66858);function p(e){return(0,a.jsx)(m.Z,{InputLabelProps:{shrink:!0},...e})}var g=n(68038),j=n(65786);function S(e){let{isOpened:t,handleClickReset:n,handleClickCancel:s}=e,[l,o]=(0,r.useState)(""),[u,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{!0===t&&o("")},[t]),(0,a.jsxs)(d.Z,{open:t,onClose:s,children:[(0,a.jsx)(h.Z,{children:"Reset Counter"}),(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(x.Z,{children:"You may specify a number, or leave it empty which by default will reset to zero."}),(0,a.jsx)(p,{type:"number",label:"Reset To",placeholder:"0",fullWidth:!0,value:l,onChange:e=>{o(t=>{if(e.target.value.length>10)return t;let n=Number(e.target.value);return""===e.target.value?e.target.value:n})},className:"mt-4"}),(0,a.jsx)(g.Z,{control:(0,a.jsx)(j.Z,{onChange:e=>{c(e.target.checked)},checked:u}),label:"Reset as an unsaved counter"})]}),(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(i.Z,{onClick:s,children:"Cancel"}),(0,a.jsx)(i.Z,{onClick:()=>n(Number(l),u),children:"Reset"})]})]})}var b=n(52326),k=n(10437);function C(e){let{isOpened:t,handleClickSave:n,handleClickCancel:s,loadedSave:l}=e,[o,u]=(0,r.useState)(""),[c,m]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{!0===t&&u(void 0!==l?l.name:"")},[t,l]),(0,a.jsxs)(d.Z,{open:t,onClose:s,children:[(0,a.jsx)(h.Z,{children:"Save Counter"}),(0,a.jsxs)(v.Z,{children:[(0,a.jsx)(x.Z,{children:"To avoid confusion with other saves, an unique name is recommended."}),(0,a.jsx)(p,{label:"Save Name",placeholder:"(Unnamed)",fullWidth:!0,InputProps:{endAdornment:(0,a.jsxs)(b.Z,{position:"end",children:[o.length,"/",50]})},value:o,onChange:e=>{u(t=>e.target.value.length>50?t:e.target.value)},className:"mt-4"}),""!==o&&void 0!==l&&o!==l.name&&!1===c&&(0,a.jsxs)(k.Z,{className:"truncate",children:["Rename as ",(0,a.jsx)("b",{children:o})]}),void 0!==l&&(0,a.jsx)(g.Z,{control:(0,a.jsx)(j.Z,{onChange:e=>{m(e.target.checked)},checked:c}),label:"Save as a new copy"})]}),(0,a.jsxs)(f.Z,{children:[(0,a.jsx)(i.Z,{onClick:s,children:"Cancel"}),(0,a.jsx)(i.Z,{onClick:()=>n(o,c),children:"Save"})]})]})}var y=n(26792),N=n(26461),w=n(34762),Z=n(57233),A=n(9936),I=n(6007),_=n(38472);let T=e=>{let{tapCount:t}=e;return 0===t?"Tap to Count":1===t?"".concat(t," Tap"):t>1?"".concat(t," Taps"):void 0};function E(){let e=(0,N.t8)(),[t,n]=(0,r.useState)(void 0),[d,f]=(0,r.useState)(0),[v,x]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1);(0,I.D)({mutationFn:e=>(console.log("mutationFn()",e),_.Z.post("/api/ping",e)),onSuccess:()=>{},onError:()=>{}});let p=async e=>{let t=await (0,Z.I)();t.set(e.id,e),t.size>y.QK&&t.delete(Array.from(t.keys())[0]),await u.u.set({key:y.I.TAP_CHANGE_HISTORIES,value:(0,w.w_)(t)})},g=async()=>{if(console.log("handleClickOpenSaveDialog()"),(await (0,Z.X)()).size>y.G_){e("You have reached the max tap save count. Please remove some of your saves to continue.");return}x(!0)},j=async(a,r)=>{let s;let l=new Date,o=await (0,Z.X)(),i=!1;r||void 0===t||void 0===o.get(t.id)?(s={id:l.getTime().toString(),name:a,tapCount:d,createdAt:l.toISOString()},o.delete(s.id),i=!0):s={...t,name:a,tapCount:d,updatedAt:l.toISOString()},o=new Map([...Array.from(o.entries()),[s.id,s]]),i&&o.size>y.G_&&e("You have reached the max tap save count. Please remove some of your saves to continue.");let c=[u.u.set({key:y.I.SAVED_TAPS,value:(0,w.w_)(o)})];i&&c.push(u.u.set({key:y.I.LOADED_SAVE_ID,value:s.id})),p({id:l.getTime().toString(),tap:s,action:"SAVE",createdAt:l.toISOString()}),Promise.allSettled(c),n(s),x(!1),e("The tap is saved.")};return(0,r.useEffect)(()=>(console.log("Mount page.tsx"),()=>console.log("Unmount page.tsx")),[]),(0,r.useEffect)(()=>{Promise.allSettled([new Promise(async e=>{let t=await u.u.get({key:y.I.LOADED_SAVE_ID});if("string"==typeof(null==t?void 0:t.value)){let e;let a=await u.u.get({key:y.I.SAVED_TAPS});if("string"==typeof a.value&&(e=(0,w.Xe)(a.value)),void 0!==e){let a=e.get(t.value);void 0!==a&&n(a)}}e(!0)}),new Promise(async e=>{let t=await u.u.get({key:y.I.TAP_COUNT});console.log("tap count res",t),"string"==typeof(null==t?void 0:t.value)&&f(Number.parseInt(t.value)),e(!0)})])},[]),(0,a.jsxs)("div",{className:"m-auto flex h-full max-w-2xl flex-1 flex-col justify-center p-4",children:[(0,a.jsxs)("div",{className:"flex w-full justify-between gap-3",children:[(0,a.jsx)(i.Z,{variant:"contained",className:"flex h-fit flex-col justify-start overflow-hidden bg-transparent p-0 shadow-none hover:bg-transparent hover:shadow-none dark:text-neutral-200",onClick:g,children:(0,a.jsxs)("div",{className:"relative rounded-md py-2 pl-3 pr-2 before:absolute before:left-0 before:top-0 before:h-full before:w-1 before:bg-emerald-600 before:content-[''] dark:bg-neutral-800 dark:hover:bg-neutral-700",children:[void 0!==t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.J,{extraClassName:"mx-2 max-w-[150px] truncate px-1 text-xs font-medium normal-case",name:t.name}),(0,a.jsx)("div",{className:"my-1 w-full border-b border-solid dark:border-neutral-200/25"})]}),(0,a.jsxs)("div",{className:"mx-2 flex items-center",children:[(0,a.jsx)(s.Z,{className:"text-xl"}),(0,a.jsx)("span",{className:"ml-1 text-sm normal-case",children:"Click to Save"})]})]})}),(0,a.jsx)(C,{isOpened:v,handleClickSave:j,handleClickCancel:()=>x(!1),loadedSave:t}),(0,a.jsx)(c,{extraClassName:"w-28 dark:bg-red-800 dark:text-white dark:hover:bg-red-700",onClick:()=>m(!0),children:(0,a.jsxs)("div",{children:[(0,a.jsx)(l.Z,{className:"text-2xl"}),(0,a.jsx)("div",{className:"text-base",children:"Reset"})]})}),(0,a.jsx)(S,{isOpened:h,handleClickReset:(a,r)=>{console.log("resetDialogHandleClickReset()",{resetCount:a,shouldResetAsUnsaved:r});let s=new Date,l=void 0===a||isNaN(a)?0:a;u.u.set({key:y.I.TAP_COUNT,value:l.toString()}),p({id:s.getTime().toString(),tap:void 0!==t?t:{tapCount:d},action:"RESET",createdAt:s.toISOString()}),r&&(u.u.remove({key:y.I.LOADED_SAVE_ID}),n(void 0)),f(l),m(!1),e("The tap is reset.")},handleClickCancel:()=>m(!1)})]}),(0,a.jsx)(c,{extraClassName:"-mt-3 w-full dark:bg-amber-500 dark:text-neutral-900 dark:hover:bg-amber-400 dark:focus:bg-amber-400",onClick:()=>{console.log("handleClickTap()"),f(e=>{let t=(e+1).toString().length<=10?e+1:e;return u.u.set({key:y.I.TAP_COUNT,value:t.toString()}),t})},children:(0,a.jsxs)("div",{className:"pt-4",children:[(0,a.jsx)("div",{className:"pb-3 text-4xl",children:(0,a.jsx)(T,{tapCount:d})}),(0,a.jsx)(o.Z,{className:"text-9xl"})]})})]})}},90354:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(57437),r=n(98784);function s(e){return(0,a.jsx)(r.Z,{...e})}},58361:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(57437),r=n(23269);function s(e){return(0,a.jsx)(r.Z,{...e})}},98067:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(57437),r=n(66124);function s(e){return(0,a.jsx)(r.Z,{...e})}},76140:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(57437),r=n(80824);function s(e){return(0,a.jsx)(r.Z,{...e})}},13287:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(57437),r=n(61096);function s(e){return(0,a.jsx)(r.Z,{...e})}},9936:function(e,t,n){"use strict";n.d(t,{J:function(){return s}});var a=n(57437),r=n(83719);let s=e=>{let{extraClassName:t,component:n="div",name:s}=e,l=void 0!==s&&""!==s;return(0,a.jsx)(r.Z,{component:n,variant:"body1",className:"".concat(l?"dark:text-neutral-200":"dark:text-neutral-200/50"," ").concat(t),children:l?s:"(Unnamed)"})}},26461:function(e,t,n){"use strict";n.d(t,{T1:function(){return o},t8:function(){return i}});var a=n(57437),r=n(2265);let s=(0,r.createContext)(null),l=(0,r.createContext)(null),o=e=>{let{children:t,isOpened:n,showNotificationMessage:r}=e;return(0,a.jsx)(s.Provider,{value:n,children:(0,a.jsx)(l.Provider,{value:r,children:t})})},i=()=>(0,r.useContext)(l)},34762:function(e,t,n){"use strict";n.d(t,{Xe:function(){return r},oX:function(){return l},tw:function(){return s},w_:function(){return a}});let a=e=>JSON.stringify(Array.from(e)),r=e=>(console.log("jsonToMap()",{json:e}),new Map(JSON.parse(e))),s=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return String.raw({raw:e},...n)},l=(e,t)=>{if(""===e.target.value)return t(""),!0;if("-"===e.target.value)return t("-"),!0;let n=parseInt(e.target.value,10);return!isNaN(n)&&(t(n),!0)}},26792:function(e,t,n){"use strict";n.d(t,{EN:function(){return l},G_:function(){return u},I:function(){return o},QK:function(){return c},ou:function(){return d},pz:function(){return i}});var a=n(48646),r=n(34762);function s(){let e=(0,a._)(["whitespace-pre"]);return s=function(){return e},e}let l={text:"#e5e7eb",background:"#171717",primary:"#f59e0b",secondary:"#10b981",neutral:"#262626"},o={TAP_COUNT:"tap-count",LOADED_SAVE_ID:"loaded-save-id",SAVED_TAPS:"saved-taps",TAP_CHANGE_HISTORIES:"tap-change-histories"},i=10,u=200,c=1e3,d={htmlInput:{className:{htmlInput:{className:(0,r.tw)(s())}}.htmlInput.className}}}},function(e){e.O(0,[3719,4544,2776,346,6858,5786,7185,6289,7323,6078,7735,2971,7023,1744],function(){return e(e.s=62802)}),_N_E=e.O()}]);